<template name="stats">

<div class="panel panel-default">
<h5> {{moFormat timeNow 'longDatewithtime'}} </h5>
Number of incidents today - {{IncidentCount}} <br>
Number of Urgent Incidents - {{UrgentIncidents}} <br>
<!--
Number of Unresolved incidents - {{UnresolvedIncidents}} <br>-->

<hr>
<a href="{{pathFor 'report'}}"><button class="btn btn-primary"><i class="fa fa-exclamation-triangle"></i> Report incident </button></a>
<button class="btn btn-default" id="showincidents"><i class="fa fa-history"></i>
{{#if GetSession 'incidentview'}} Hide {{else}} Show {{/if}} Incidents </button>

<br>
<br>
</div>

{{>psiVIEW}}



</template>

<template name="incidentview">
{{> autoformModals}}
<h3> Latest Incident Reports </h3>

{{#if Incidents}}
<div class="panel-group">
{{#each Incidents}}

<div class="panel panel-{{incidentStatusColor status}}">
<div class="panel-heading">


{{#if equals status 'resolved'}}<i class="fa fa-check"></i>{{/if}}
{{#if equals status 'urgent'}}<i class="fa fa-exclamation-circle"></i>{{/if}}
{{#if equals status 'verified'}}<i class="fa fa-dot-circle-o"></i>{{/if}}
 {{type}} 
</div>
<div class="panel-body">


<p> {{comment}}</p>

<small>{{moFormat reportedTime 'longDatewithtime'}}</small>

</div>
<div class="panel-footer">
<!--
<button class="btn btn-default" id="showlocation"><i class="fa fa-map-marker"></i> Show Location </button>
<button class="btn btn-default" id="showpanorama"><i class="fa fa-map-marker"></i> Street View</button>-->
<div class="btn-group" role="group" aria-label="...">
<div class="btn-group">
  <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    <i class="fa fa-eye"></i> View
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="#" id="showlocation"><i class="fa fa-map-marker"></i> &nbsp; Map View</a></li>
    <li><a href="#" id="showpanorama"><i class="fa fa-location-arrow"></i>&nbsp; Street View</a></li>
  </ul>
</div>
<div class="btn-group">
  <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    <i class="fa fa-eye"></i> Status
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    {{#unless equals status 'verified'}}
    <li><a href="#" id="markverified"><i class="fa fa-check-circle-o"></i>&nbsp;Mark Verified</a></li>
    {{/unless}}
    {{#unless equals status 'resolved'}}
    <li><a href="#" id="markresolved"><i class="fa fa-location-arrow"></i>&nbsp;Mark Resolved</a></li>
    {{/unless}}
    {{#unless equals status 'urgent'}}
      <li><a href="#" id="markurgent"><i class="fa fa-exclamation-circle"></i>&nbsp;Mark Urgent</a></li>
      {{/unless}}
  </ul>
</div>
<button class="btn btn-default btn-sm" id="takeaction"><i class="fa fa-bolt"></i> Take action </button>


</div>
</div>
</div>


{{/each}}
</div>
{{/if}}

</template>

<!--TO BE REFACTORED --> 
<template name="singleincidentview">

<div class="panel panel-primary">
<div class="panel-heading">
<h3> {{SingleIncident.type}}</h3>
Case ID:{{SingleIncident._id}}
<br>
</div>
<div class="panel-body">
<p>{{SingleIncident.comment}}</p>
Reported On: {{moFormat SingleIncident.reportedTime 'longDatewithtime'}} <br>
</div>
<div class="panel-footer">

<div class="btn-group" role="group" aria-label="...">
<div class="btn-group">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    <i class="fa fa-eye"></i> Mark Status
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="#" id="showlocation"><i class="fa fa-check-circle-o"></i>&nbsp;Mark Verified</a></li>
    <li><a href="#" id="showpanorama"><i class="fa fa-location-arrow"></i>&nbsp;Mark Resolved</a></li>
  </ul>
</div>
<button class="btn btn-default"><i class="fa fa-bolt"></i> Take action </button>
</div>



</div>
</div>



</template>

<!--View component to display PSI-->

<template name="psiVIEW">
<div class="panel panel-default">

<h3> Current Haze Status </h3>
<h5> {{moFormat latestPSI.[0].[0].timestamp 'longDatewithtime'}} </h5>
Central Region - {{latestPSI.[0].[2].reading.[0].value}} <br>
North Region - {{latestPSI.[0].[0].reading.[0].value}} <br>
East Region - {{latestPSI.[0].[3].reading.[0].value}} <br>
West Region - {{latestPSI.[0].[4].reading.[0].value}} <br>
South Region - {{latestPSI.[0].[5].reading.[0].value}} <br>
<!--National Reporting Center- {{latestPSI.[0].[1].reading.[0].value}} <br>-->
<br>



<!--This should be kept for detailed analytics-->
<!--
{{latestPSI.[0].[0].reading.[1].type}} - {{latestPSI.[0].[0].reading.[1].value}} <br>
{{latestPSI.[0].[0].reading.[2].type}} - {{latestPSI.[0].[0].reading.[2].value}} <br>
{{latestPSI.[0].[0].reading.[3].type}} - {{latestPSI.[0].[0].reading.[3].value}} <br>
{{latestPSI.[0].[0].reading.[4].type}} - {{latestPSI.[0].[0].reading.[4].value}} <br>
{{latestPSI.[0].[0].reading.[5].type}}- {{latestPSI.[0].[0].reading.[5].value}} <br>
{{latestPSI.[0].[0].reading.[6].type}} - {{latestPSI.[0].[0].reading.[6].value}} <br>-->


<!--
<b> North: </b> {{northReadings.reading.[0].value}}
{{northReadings.timestamp}}-->

</div>
</template>


<!--ACTION MODAL FOR TAKE ACTION BUTTON -->

<template name="actionModal">
    <div class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h4 class="modal-title">Case Id: {{_id}} - {{type}}</h4>
                </div>

                <div class="modal-body">
  <center>
                    The following actions can be taken<hr>
                    <div class="btn-group-vertical" aria-label="...">
<button class="btn btn-default text-left"><i class="fa fa-ambulance fa-fw"></i> &nbsp; Dispatch Ambulance </button>
  <button class="btn btn-default text-left"> <i class="fa fa-taxi fa-fw"></i> &nbsp; Contact Police </button> 
  <button class="btn btn-default text-left"><i class="fa fa-tty fa-fw"></i> &nbsp; Contact Relevant Authorities </button>
      <button class="btn btn-default text-left"> <i class="fa fa-facebook fa-fw"></i>&nbsp; Broadcast to Social Media </button>
           <button class="btn btn-default text-left"> <i class="fa fa-users fa-fw"></i>&nbsp; Notify Subscribers </button>
                  <button class="btn btn-default text-left"><i class="fa fa-check-square-o fa-fw"></i>&nbsp; Mark Resolved </button>
                </div>
                <br>
                <br>
</center>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>

            </div>
        </div>
    </div>
    </div>
</template>

