<template name="stats">

<div class="panel panel-default">
<h5> {{moFormat timeNow 'longDatewithtime'}} </h5>

{{#if isInRole 'operator'}}
<h6> Welcome Operator! </h6>
<small> Number of incidents today </small>
<div class="col-lg-6 col-lg-offset-3 incident-count">
 {{IncidentCount}} 
 </div>
 <br>
 <br>
 <br>
<!--Number of Urgent Incidents - {{UrgentIncidents}} <br>-->
{{else}}
<div class="col-lg-10 col-lg-offset-1">
<div class="well">
<p> Welcome! Member of the public. Our CMS provides real-time
up to date information regardings incidents happening around country.
Our mission is to keep Singapore safe! Please report incidents to us at
<i> +65 67343298 </i> </p>
</div>
</div>

{{/if}}

<br>
<br>
<a href="{{pathFor 'report'}}"><button class="btn btn-primary"><i class="fa fa-exclamation-triangle"></i> Report incident </button></a>
<button class="btn btn-default" id="showincidents"><i class="fa fa-history"></i>
{{#if GetSession 'incidentview'}} Hide {{else}} Show {{/if}} Incidents </button>

<br>
<br>
</div>

{{#if GetSession 'psiView'}}
{{>psiVIEW}}
{{/if}}



</template>

<template name="incidentview">
<div class="text-center">
{{> autoformModals}}

<h3> Latest Incident Reports </h3>
<div class="form-group">
<input type="text" class="form-control" id="search-box" placeholder="Search">
</div>
{{#if Incidents}}
<div class="panel-group">
{{#each Incidents}}

<div class="panel panel-{{incidentStatusColor status}}">
<div class="panel-heading">


{{#if equals status 'resolved'}}<i class="fa fa-check"></i>{{/if}}
{{#if equals status 'urgent'}}<i class="fa fa-exclamation-circle"></i>{{/if}}
{{#if equals status 'verified'}}<i class="fa fa-dot-circle-o"></i>{{/if}}
 {{type}} 
</div>
<div class="panel-body">


<p> {{comment}}</p>

<small>{{moFormat reportedTime 'longDatewithtime'}}</small>

</div>
<div class="panel-footer">
<!--
<button class="btn btn-default" id="showlocation"><i class="fa fa-map-marker"></i> Show Location </button>
<button class="btn btn-default" id="showpanorama"><i class="fa fa-map-marker"></i> Street View</button>-->
<div class="btn-group" role="group" aria-label="...">
<div class="btn-group">
  <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    <i class="fa fa-eye"></i> View
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    <li><a href="#" id="showlocation"><i class="fa fa-map-marker"></i> &nbsp; Map View</a></li>
    <li><a href="#" id="showpanorama"><i class="fa fa-location-arrow"></i>&nbsp; Street View</a></li>
  </ul>
</div>
  {{#if isInRole 'operator'}}
<div class="btn-group">
  <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    <i class="fa fa-eye"></i> Status
    <span class="caret"></span>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
    {{#unless equals status 'verified'}}
    <li><a href="#" id="markverified"><i class="fa fa-check-circle-o"></i>&nbsp;Mark Verified</a></li>
    {{/unless}}
    {{#unless equals status 'resolved'}}
    <li><a href="#" id="markresolved"><i class="fa fa-location-arrow"></i>&nbsp;Mark Resolved</a></li>
    {{/unless}}
    {{#unless equals status 'urgent'}}
      <li><a href="#" id="markurgent"><i class="fa fa-exclamation-circle"></i>&nbsp;Mark Urgent</a></li>
      {{/unless}}
  </ul>
</div>

<button class="btn btn-default btn-sm" id="takeaction"><i class="fa fa-bolt"></i> Take action </button>
{{/if}}

</div>
</div>
</div>


{{/each}}
</div>

{{/if}}
</div>

</template>


<!--View component to display PSI-->

<template name="psiVIEW">
<div class="panel panel-default">
<div class="panel-heading">

<h4> Current Haze Status </h4></div>
<div class="panel-body">
<div class="text-center">
<div class="row">
<div class="col-lg-2 col-lg-offset-1"> Central  <br> {{latestPSI.[0].[2].reading.[0].value}} </div>
<div class="col-lg-2"> North  <br> {{latestPSI.[0].[0].reading.[0].value}} </div>
<div class="col-lg-2"> East  <br> {{latestPSI.[0].[3].reading.[0].value}} </div>
<div class="col-lg-2"> West <br> {{latestPSI.[0].[4].reading.[0].value}} </div>
<div class="col-lg-2"> South <br> {{latestPSI.[0].[5].reading.[0].value}} </div>
</div>
<hr>
<small> Last update: {{moFormat latestPSI.[0].[0].timestamp 'longDatewithtime'}} </small><br>

<button class="btn btn-default btn-transparent btn-sm pull-center" id="closePSI"> <i class="fa fa-remove"> </i> Close </button>

<button class="btn btn-default btn-transparent btn-sm pull-center"> <i class="fa fa-area-chart"></i> Statistics</button>
<!--National Reporting Center- {{latestPSI.[0].[1].reading.[0].value}} <br>-->
<br>
</div>
</div>


<!--This should be kept for detailed analytics-->
<!--
{{latestPSI.[0].[0].reading.[1].type}} - {{latestPSI.[0].[0].reading.[1].value}} <br>
{{latestPSI.[0].[0].reading.[2].type}} - {{latestPSI.[0].[0].reading.[2].value}} <br>
{{latestPSI.[0].[0].reading.[3].type}} - {{latestPSI.[0].[0].reading.[3].value}} <br>
{{latestPSI.[0].[0].reading.[4].type}} - {{latestPSI.[0].[0].reading.[4].value}} <br>
{{latestPSI.[0].[0].reading.[5].type}}- {{latestPSI.[0].[0].reading.[5].value}} <br>
{{latestPSI.[0].[0].reading.[6].type}} - {{latestPSI.[0].[0].reading.[6].value}} <br>-->


<!--
<b> North: </b> {{northReadings.reading.[0].value}}
{{northReadings.timestamp}}-->

</div>
</template>


<!--ACTION MODAL FOR TAKE ACTION BUTTON -->

<template name="actionModal">
    <div class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header text-center">
                    <h4 class="modal-title">Case Id: {{_id}} - {{type}}</h4>
                </div>

                <div class="modal-body">

<div class='well text-center'>
<p>  {{comment}}<br> <i> reported by:{{contact}}</i> </p>


</div>              

<div class="row text-center">
<div class="col-lg-4">

<button class="btn btn-default btn-sm fixed-button">
<i class="fa fa-envelope-o fa-3x"></i> <br>
Notify Email </button>

</div>

<div class="col-lg-4">

<button class="btn btn-default btn-sm fixed-button">
<i class="fa fa-feed fa-3x"></i> <br>
Notify Subscribers</button>

</div>
<div class="col-lg-4">

<button class="btn btn-default btn-sm fixed-button">
<i class="fa fa-building fa-3x"></i> <br>
Notify Authorities</button>

</div>
<!--
<div class="col-lg-3">

<button class="btn btn-default btn-sm fixed-button">
<i class="fa fa-ambulance fa-3x"></i> <br>
<small> Alert Police/Ambulance </small></button>


</div>-->
</div>


 </div>

               

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>

           
        </div>
    </div>
    </div>
</template>

